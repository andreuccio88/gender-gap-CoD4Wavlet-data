usa_F$Age[usa_F$variable=="m60"] <- 60
usa_F$Age[usa_F$variable=="m65"] <- 65
usa_F$Age[usa_F$variable=="m70"] <- 70
usa_F$Age[usa_F$variable=="m75"] <- 75
usa_F$Age[usa_F$variable=="m80"] <- 80
usa_F$Age[usa_F$variable=="m85"] <- 85
usa_F$Age[usa_F$variable=="m90"] <- 90
usa_F$Age[usa_F$variable=="m95"] <- 95
usa_F$Age[usa_F$variable=="m100p"] <- 100
str(usa_F)
usa$cause
library(data.table)
usa_F <- as.data.table(usa_F)
head(usa_F)
names(usa_F)[4]<-"mx.tot.by.Caus"
head(usa_F)
usa_F$Cause_Rev[usa_F$cause==1] <- 1 # inf
usa_F$Cause_Rev[usa_F$cause==2] <- 2 # neop
usa_F$Cause_Rev[usa_F$cause==3] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==4] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==5] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==6] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==7] <- 3 # CVD
usa_F$Cause_Rev[usa_F$cause==8] <- 3 # CVD
usa_F$Cause_Rev[usa_F$cause==9] <- 3 # CVD
usa_F$Cause_Rev[usa_F$cause==10] <- 4 # RESP
usa_F$Cause_Rev[usa_F$cause==11] <- 4 # RESP
usa_F$Cause_Rev[usa_F$cause==12] <- 5 # DIG
usa_F$Cause_Rev[usa_F$cause==13] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==14] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==15] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==16] <- 6 # ext
#usa_F$Age <- as.character(usa_F$Age)
head(usa_F)
usa_F$mx.tot.by.Caus <- usa_F$mx.tot.by.Caus/1000000
usa_F %>%filter(year==1979,Age%in%c(0),cause%in%c(7,8,9)) %>%select(mx.tot.by.Caus) %>%  sum()
str(usa)
usa_F=usa_F[,.(mx.tot.by.Caus = sum(mx.tot.by.Caus)), keyby = .(year, Cause_Rev, Age)]
head(usa_F)
usa_F %>% filter(Cause_Rev==3)
usa_F %>%filter(year==1979) %>% ggplot(aes(Age,log(mx.tot.by.Caus)))+geom_line()+facet_wrap(~Cause_Rev)
usa_F$Sex <- "F"
load("usa_M.RData")
usa_M
names(usa_F)[4]<-"mx.tot.by.Caus_F"
head(usa_F)
tot <- cbind(usa_F,usa_M)
tot$gender_gap <- tot$mx.tot.by.Caus/tot$mx.tot.by.Caus_F
head(tot)
tot <- tot[,c(1,2,3,11)]
tot %>%filter(year==2000) %>% ggplot(aes(Age,(gender_gap)))+geom_line()+facet_wrap(~Cause_Rev,scales = "free")
summary(tot$gender_gap)
head(tot)
tot$Cohort <- tot$year-tot$Age
tot %>%filter(Age==25) %>% ggplot(aes(Cohort,(gender_gap)))+geom_line()+
facet_wrap(~Cause_Rev,scales = "free")
rm()
rm(list=ls()).
rm(list=ls())
usa <- read.csv("USA_m_short_idr.csv",header = T)
head(usa)
load("usa_M.RData")
names(usa_F)[4]<-"mx.tot.by.Caus_F"
head(usa_F)
rm(list=ls())
library(tidyverse)
library(reshape)
library(data.table)
usa <- read.csv("USA_m_short_idr.csv",header = T)
usa_F <- usa %>% filter(sex==2,cause!=0) #select 2-female
usa_F <- usa_F[,-c(1,3,4,5,25,27,29)]
usa_F <- melt(usa_F, id.vars =c("cause","year"), measure.vars = c("m0", "m1", "m5", "m10",
"m15", "m20", "m25", "m30",
"m35", "m40", "m45", "m50",
"m55", "m60", "m65", "m70",
"m75", "m80", "m85", "m90",
"m95","m100p"))
usa_F$Age <- NA
# ricodifica eta
usa_F$Age[usa_F$variable=="m0"] <- 0
usa_F$Age[usa_F$variable=="m1"] <- 1
usa_F$Age[usa_F$variable=="m5"] <- 5
usa_F$Age[usa_F$variable=="m10"] <- 10
usa_F$Age[usa_F$variable=="m15"] <- 15
usa_F$Age[usa_F$variable=="m20"] <- 20
usa_F$Age[usa_F$variable=="m25"] <- 25
usa_F$Age[usa_F$variable=="m30"] <- 30
usa_F$Age[usa_F$variable=="m35"] <- 35
usa_F$Age[usa_F$variable=="m40"] <- 40
usa_F$Age[usa_F$variable=="m45"] <- 45
usa_F$Age[usa_F$variable=="m50"] <- 50
usa_F$Age[usa_F$variable=="m55"] <- 55
usa_F$Age[usa_F$variable=="m60"] <- 60
usa_F$Age[usa_F$variable=="m65"] <- 65
usa_F$Age[usa_F$variable=="m70"] <- 70
usa_F$Age[usa_F$variable=="m75"] <- 75
usa_F$Age[usa_F$variable=="m80"] <- 80
usa_F$Age[usa_F$variable=="m85"] <- 85
usa_F$Age[usa_F$variable=="m90"] <- 90
usa_F$Age[usa_F$variable=="m95"] <- 95
usa_F$Age[usa_F$variable=="m100p"] <- 100
usa_F <- as.data.table(usa_F)
names(usa_F)[4]<-"mx.tot.by.Caus"
# Classificazione cause
usa_F$Cause_Rev[usa_F$cause==1] <- 1 # inf
usa_F$Cause_Rev[usa_F$cause==2] <- 2 # neop
usa_F$Cause_Rev[usa_F$cause==3] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==4] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==5] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==6] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==7] <- 3 # CVD
usa_F$Cause_Rev[usa_F$cause==8] <- 3 # CVD
usa_F$Cause_Rev[usa_F$cause==9] <- 3 # CVD
usa_F$Cause_Rev[usa_F$cause==10] <- 4 # RESP
usa_F$Cause_Rev[usa_F$cause==11] <- 4 # RESP
usa_F$Cause_Rev[usa_F$cause==12] <- 5 # DIG
usa_F$Cause_Rev[usa_F$cause==13] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==14] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==15] <- 7 # oth
usa_F$Cause_Rev[usa_F$cause==16] <- 6 # ext
usa_F$mx.tot.by.Caus <- usa_F$mx.tot.by.Caus/1000000
usa_F %>%filter(year==1979,Age%in%c(0),cause%in%c(7,8,9)) %>%select(mx.tot.by.Caus) %>%  sum()
usa_F=usa_F[,.(mx.tot.by.Caus = sum(mx.tot.by.Caus)), keyby = .(year, Cause_Rev, Age)]
usa_F %>% filter(Cause_Rev==3)
usa_F %>%filter(year==1979) %>% ggplot(aes(Age,log(mx.tot.by.Caus)))+geom_line()+facet_wrap(~Cause_Rev)
usa_F$Sex <- "F"
load("usa_M.RData")
names(usa_F)[4]<-"mx.tot.by.Caus_F"
head(usa_F)
tot <- cbind(usa_F,usa_M)
tot$gender_gap <- tot$mx.tot.by.Caus/tot$mx.tot.by.Caus_F
head(tot)
tot %>%filter(year==2000) %>% ggplot(aes(Age,(gender_gap)))+geom_line()+facet_wrap(~Cause_Rev,scales = "free")
tot <- tot[,c(1,2,3,11)]
tot %>%filter(year==2000) %>% ggplot(aes(Age,(gender_gap)))+geom_line()+facet_wrap(~Cause_Rev,scales = "free")
tot$Cohort <- tot$year-tot$Age
tot %>%filter(Age==25) %>% ggplot(aes(Cohort,(gender_gap)))+geom_line()+
facet_wrap(~Cause_Rev,scales = "free")
usa <- read.csv("USA_d_short_idr.csv",header = T)
head(usa)
usa_M <- usa %>% filter(sex==1,cause!=0)
usa_M$country
library(tidyverse)
library(reshape)
usa <- read.csv("USA_d_short_idr.csv",header = T)
head(usa)
usa_M <- usa %>% filter(sex==1,cause!=0)
usa_M$country
head(usa_M)
str(usa_M)
head(usa_M[,2])
head(usa_M[,c(1,2,3,4,5,6,7,25,26,27,28,29,30,31)])
head(usa_M[,-c(1,3,4,5,7,26,28,30)])
usa_M <- usa_M[,-c(1,3,4,5,7,26,28,30)]
head(usa_M)
usa_M <- melt(usa_M, id.vars =c("cause","year"), measure.vars = c("d0", "d1", "d5", "d10",
"d15", "d20", "d25", "d30",
"d35", "d40", "d45", "d50",
"d55", "d60", "d65", "d70",
"d75", "d80", "d85", "d90",
"d95","d100p"))
library(data.table)
usa_M$Age <- NA
usa_M$Age[usa_M$variable=="d0"] <- 0
usa_M$Age[usa_M$variable=="d1"] <- 1
usa_M$Age[usa_M$variable=="d5"] <- 5
usa_M$Age[usa_M$variable=="d10"] <- 10
usa_M$Age[usa_M$variable=="d15"] <- 15
usa_M$Age[usa_M$variable=="d20"] <- 20
usa_M$Age[usa_M$variable=="d25"] <- 25
usa_M$Age[usa_M$variable=="d30"] <- 30
usa_M$Age[usa_M$variable=="d35"] <- 35
usa_M$Age[usa_M$variable=="d40"] <- 40
usa_M$Age[usa_M$variable=="d45"] <- 45
usa_M$Age[usa_M$variable=="d50"] <- 50
usa_M$Age[usa_M$variable=="d55"] <- 55
usa_M$Age[usa_M$variable=="d60"] <- 60
usa_M$Age[usa_M$variable=="d65"] <- 65
usa_M$Age[usa_M$variable=="d70"] <- 70
usa_M$Age[usa_M$variable=="d75"] <- 75
usa_M$Age[usa_M$variable=="d80"] <- 80
usa_M$Age[usa_M$variable=="d85"] <- 85
usa_M$Age[usa_M$variable=="d90"] <- 90
usa_M$Age[usa_M$variable=="d95"] <- 95
usa_M$Age[usa_M$variable=="d100p"] <- 100
str(usa_M)
usa_M <- as.data.table(usa_M)
head(usa_M)
names(usa_M)[4]<-"dx.tot.by.Caus"
head(usa_M)
usa_M$Cause_Rev[usa_M$cause==1] <- 1 # inf
usa_M$Cause_Rev[usa_M$cause==2] <- 2 # neop
usa_M$Cause_Rev[usa_M$cause==3] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==4] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==5] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==6] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==7] <- 3 # CVD
usa_M$Cause_Rev[usa_M$cause==8] <- 3 # CVD
usa_M$Cause_Rev[usa_M$cause==9] <- 3 # CVD
usa_M$Cause_Rev[usa_M$cause==10] <- 4 # RESP
usa_M$Cause_Rev[usa_M$cause==11] <- 4 # RESP
usa_M$Cause_Rev[usa_M$cause==12] <- 5 # DIG
usa_M$Cause_Rev[usa_M$cause==13] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==14] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==15] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==16] <- 6 # ext
#usa_M$Age <- as.character(usa_M$Age)
head(usa_M)
usa_M %>%filter(year==1979,Age%in%c(0),cause%in%c(7,8,9)) %>%select(dx.tot.by.Caus) %>%  sum()
str(usa)
#usa_M$Age <- as.character(usa_M$Age)
head(usa_M)
usa_M=usa_M[,.(dx.tot.by.Caus = sum(dx.tot.by.Caus)), keyby = .(year, Cause_Rev, Age)]
head(usa_M)
usa_M %>% filter(Cause_Rev==3)
usa_M %>%filter(year==1979) %>% ggplot(aes(Age,log(dx.tot.by.Caus)))+geom_line()+facet_wrap(~Cause_Rev)
usa_M=usa_M[,.(dx.tot.by.Caus = sum(dx.tot.by.Caus)), keyby = .(year, Cause_Rev)]
head(usa_M)
usa_M$Sex <- "m"
save(usa_M,file="dx_usa_M.RData")
Ex<- read.csv("USA_e.csv",header = T)
head(Ex)
head(Ex)
Ex_M <- Ex %>% filter(sex==1)
Ex_M[,-c(1,3,4,5,7,26,28,30)]
head(Ex_M)
Ex_M[,c(24)]
Ex_M[,c(24,25)]
head(Ex_M[,c(24,25)])
head(Ex_M[,c(25,26)])
head(Ex_M[,c(26,27)])
head(Ex_M[,c(27,28)])
head(usa_M)
# 1-males, 2-females, 3-both sexes
########################
#                      #
# Number of death      #
#                      #
########################
library(tidyverse)
library(data.table)
library(reshape)
usa <- read.csv("USA_d_short_idr.csv",header = T)
head(usa)
usa_M <- usa %>% filter(sex==1,cause!=0)
usa_M <- usa_M[,-c(1,3,4,5,7,26,28,30)]
usa_M <- melt(usa_M, id.vars =c("cause","year"), measure.vars = c("d0", "d1", "d5", "d10",
"d15", "d20", "d25", "d30",
"d35", "d40", "d45", "d50",
"d55", "d60", "d65", "d70",
"d75", "d80", "d85", "d90",
"d95","d100p"))
usa_M$Age <- NA
usa_M$Age[usa_M$variable=="d0"] <- 0
usa_M$Age[usa_M$variable=="d1"] <- 1
usa_M$Age[usa_M$variable=="d5"] <- 5
usa_M$Age[usa_M$variable=="d10"] <- 10
usa_M$Age[usa_M$variable=="d15"] <- 15
usa_M$Age[usa_M$variable=="d20"] <- 20
usa_M$Age[usa_M$variable=="d25"] <- 25
usa_M$Age[usa_M$variable=="d30"] <- 30
usa_M$Age[usa_M$variable=="d35"] <- 35
usa_M$Age[usa_M$variable=="d40"] <- 40
usa_M$Age[usa_M$variable=="d45"] <- 45
usa_M$Age[usa_M$variable=="d50"] <- 50
usa_M$Age[usa_M$variable=="d55"] <- 55
usa_M$Age[usa_M$variable=="d60"] <- 60
usa_M$Age[usa_M$variable=="d65"] <- 65
usa_M$Age[usa_M$variable=="d70"] <- 70
usa_M$Age[usa_M$variable=="d75"] <- 75
usa_M$Age[usa_M$variable=="d80"] <- 80
usa_M$Age[usa_M$variable=="d85"] <- 85
usa_M$Age[usa_M$variable=="d90"] <- 90
usa_M$Age[usa_M$variable=="d95"] <- 95
usa_M$Age[usa_M$variable=="d100p"] <- 100
str(usa_M)
usa_M <- as.data.table(usa_M)
head(usa_M)
names(usa_M)[4]<-"dx.tot.by.Caus"
#names(usa)[2]<-"Year"
head(usa_M)
usa_M$Cause_Rev[usa_M$cause==1] <- 1 # inf
usa_M$Cause_Rev[usa_M$cause==2] <- 2 # neop
usa_M$Cause_Rev[usa_M$cause==3] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==4] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==5] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==6] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==7] <- 3 # CVD
usa_M$Cause_Rev[usa_M$cause==8] <- 3 # CVD
usa_M$Cause_Rev[usa_M$cause==9] <- 3 # CVD
usa_M$Cause_Rev[usa_M$cause==10] <- 4 # RESP
usa_M$Cause_Rev[usa_M$cause==11] <- 4 # RESP
usa_M$Cause_Rev[usa_M$cause==12] <- 5 # DIG
usa_M$Cause_Rev[usa_M$cause==13] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==14] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==15] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==16] <- 6 # ext
#usa_M$Age <- as.character(usa_M$Age)
head(usa_M)
usa_M %>%filter(year==1979,Age%in%c(0),cause%in%c(7,8,9)) %>%select(dx.tot.by.Caus) %>%  sum()
str(usa)
usa_M=usa_M[,.(dx.tot.by.Caus = sum(dx.tot.by.Caus)), keyby = .(year, Cause_Rev, Age)]
head(usa_M)
usa_M %>% filter(Cause_Rev==3)
head(usa_M)
Ex<- read.csv("USA_e.csv",header = T)
head(Ex)
Ex_M <- Ex %>% filter(sex==1)
head(Ex_M)
head(Ex_M[,c(27,28)])
head(Ex_M[,c(28,29)])
head(Ex_M[,c(29,30)])
head(Ex_M[,c(28,29,30)])
Ex_M[,-c(1,3,4,5,26,28)]
head(Ex_M[,-c(1,3,4,5,26,28)])
Ex_M <- Ex_M[,-c(1,3,4,5,26,28)]
Ex_M <- melt(Ex_M, id.vars =c("cause","year"), measure.vars = c("e0", "e1", "e5", "e10",
"e15", "e20", "e25", "e30",
"e35", "e40", "e45", "e50",
"e55", "e60", "e65", "e70",
"e75", "e80", "e85", "e90",
"e95","e100p"))
Ex_M <- melt(Ex_M, id.vars =c("year"), measure.vars = c("e0", "e1", "e5", "e10",
"e15", "e20", "e25", "e30",
"e35", "e40", "e45", "e50",
"e55", "e60", "e65", "e70",
"e75", "e80", "e85", "e90",
"e95","e100p"))
head(Ex_M)
Ex<- read.csv("USA_e.csv",header = T)
head(Ex)
Ex_M <- Ex %>% filter(sex==1)
head(Ex_M)
Ex_M <- Ex_M[,-c(1,3,4,5,26,28)]
head(Ex_M)
Ex_M <- melt(Ex_M, id.vars =c("year"), measure.vars = c("e0", "e1", "e5", "e10",
"e15", "e20", "e25", "e30",
"e35", "e40", "e45", "e50",
"e55", "e60", "e65", "e70",
"e75", "e80", "e85", "e90",
"e95","e100p"))
head(Ex_M)
Ex_M$Age <- NA
Ex_M$Age[Ex_M$variable=="e0"] <- 0
Ex_M$Age[Ex_M$variable=="e1"] <- 1
Ex_M$Age[Ex_M$variable=="e5"] <- 5
Ex_M$Age[Ex_M$variable=="e10"] <- 10
Ex_M$Age[Ex_M$variable=="e15"] <- 15
Ex_M$Age[Ex_M$variable=="e20"] <- 20
Ex_M$Age[Ex_M$variable=="e25"] <- 25
Ex_M$Age[Ex_M$variable=="e30"] <- 30
Ex_M$Age[Ex_M$variable=="e35"] <- 35
Ex_M$Age[Ex_M$variable=="e40"] <- 40
Ex_M$Age[Ex_M$variable=="e45"] <- 45
Ex_M$Age[Ex_M$variable=="e50"] <- 50
Ex_M$Age[Ex_M$variable=="e55"] <- 55
Ex_M$Age[Ex_M$variable=="e60"] <- 60
Ex_M$Age[Ex_M$variable=="e65"] <- 65
Ex_M$Age[Ex_M$variable=="e70"] <- 70
Ex_M$Age[Ex_M$variable=="e75"] <- 75
Ex_M$Age[Ex_M$variable=="e80"] <- 80
Ex_M$Age[Ex_M$variable=="e85"] <- 85
Ex_M$Age[Ex_M$variable=="e90"] <- 90
Ex_M$Age[Ex_M$variable=="e95"] <- 95
Ex_M$Age[Ex_M$variable=="e100p"] <- 100
str(Ex_M)
head(Ex_M)
Ex_M=Ex_M[,.(Exp = sum(value)), keyby = .(year)]
Ex_M=Ex_M[,.(Exp = sum(value)), keyby = year]
Ex_M=Ex_M[,(Exp = sum(value)), keyby = year]
Ex_M=Ex_M[,(Exp = sum(value)), keyby = "year"]
Ex_M=Ex_M[,.(Exp = sum(value)), keyby = .(year, Age)]
head(Ex_M)
Ex_M <- as.data.table(Ex_M)
Ex_M=Ex_M[,.(Exp = sum(value)), keyby = .(year)]
head(Ex_M)
Ex_M$Sex <- "m"
save(Ex_M,file="Ex_usa_M.RData")
Ex<- read.csv("USA_e.csv",header = T)
head(Ex)
head(USA_M)
# 1-males, 2-females, 3-both sexes
########################
#                      #
# Number of death      #
#                      #
########################
library(tidyverse)
library(data.table)
library(reshape)
usa <- read.csv("USA_d_short_idr.csv",header = T)
head(usa)
usa_M <- usa %>% filter(sex==1,cause!=0)
usa_M <- usa_M[,-c(1,3,4,5,7,26,28,30)]
usa_M <- melt(usa_M, id.vars =c("cause","year"), measure.vars = c("d0", "d1", "d5", "d10",
"d15", "d20", "d25", "d30",
"d35", "d40", "d45", "d50",
"d55", "d60", "d65", "d70",
"d75", "d80", "d85", "d90",
"d95","d100p"))
usa_M$Age <- NA
usa_M$Age[usa_M$variable=="d0"] <- 0
usa_M$Age[usa_M$variable=="d1"] <- 1
usa_M$Age[usa_M$variable=="d5"] <- 5
usa_M$Age[usa_M$variable=="d10"] <- 10
usa_M$Age[usa_M$variable=="d15"] <- 15
usa_M$Age[usa_M$variable=="d20"] <- 20
usa_M$Age[usa_M$variable=="d25"] <- 25
usa_M$Age[usa_M$variable=="d30"] <- 30
usa_M$Age[usa_M$variable=="d35"] <- 35
usa_M$Age[usa_M$variable=="d40"] <- 40
usa_M$Age[usa_M$variable=="d45"] <- 45
usa_M$Age[usa_M$variable=="d50"] <- 50
usa_M$Age[usa_M$variable=="d55"] <- 55
usa_M$Age[usa_M$variable=="d60"] <- 60
usa_M$Age[usa_M$variable=="d65"] <- 65
usa_M$Age[usa_M$variable=="d70"] <- 70
usa_M$Age[usa_M$variable=="d75"] <- 75
usa_M$Age[usa_M$variable=="d80"] <- 80
usa_M$Age[usa_M$variable=="d85"] <- 85
usa_M$Age[usa_M$variable=="d90"] <- 90
usa_M$Age[usa_M$variable=="d95"] <- 95
usa_M$Age[usa_M$variable=="d100p"] <- 100
str(usa_M)
usa_M <- as.data.table(usa_M)
head(usa_M)
names(usa_M)[4]<-"dx.tot.by.Caus"
#names(usa)[2]<-"Year"
head(usa_M)
usa_M$Cause_Rev[usa_M$cause==1] <- 1 # inf
usa_M$Cause_Rev[usa_M$cause==2] <- 2 # neop
usa_M$Cause_Rev[usa_M$cause==3] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==4] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==5] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==6] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==7] <- 3 # CVD
usa_M$Cause_Rev[usa_M$cause==8] <- 3 # CVD
usa_M$Cause_Rev[usa_M$cause==9] <- 3 # CVD
usa_M$Cause_Rev[usa_M$cause==10] <- 4 # RESP
usa_M$Cause_Rev[usa_M$cause==11] <- 4 # RESP
usa_M$Cause_Rev[usa_M$cause==12] <- 5 # DIG
usa_M$Cause_Rev[usa_M$cause==13] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==14] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==15] <- 7 # oth
usa_M$Cause_Rev[usa_M$cause==16] <- 6 # ext
#usa_M$Age <- as.character(usa_M$Age)
head(usa_M)
usa_M %>%filter(year==1979,Age%in%c(0),cause%in%c(7,8,9)) %>%select(dx.tot.by.Caus) %>%  sum()
str(usa)
usa_M=usa_M[,.(dx.tot.by.Caus = sum(dx.tot.by.Caus)), keyby = .(year, Cause_Rev, Age)]
head(usa_M)
usa_M %>% filter(Cause_Rev==3)
usa_M %>%filter(year==1979) %>% ggplot(aes(Age,log(dx.tot.by.Caus)))+geom_line()+facet_wrap(~Cause_Rev)
usa_M=usa_M[,.(dx.tot.by.Caus = sum(dx.tot.by.Caus)), keyby = .(year, Cause_Rev)]
head(usa_M)
usa_M$Sex <- "m"
save(usa_M,file="dx_usa_M.RData")
############################################################
Ex<- read.csv("USA_e.csv",header = T)
head(Ex)
head(Ex)
Ex_M <- Ex %>% filter(sex==1)
head(Ex_M)
Ex_M <- Ex_M[,-c(1,3,4,5,26,28)]
Ex_M <- melt(Ex_M, id.vars =c("year"), measure.vars = c("e0", "e1", "e5", "e10",
"e15", "e20", "e25", "e30",
"e35", "e40", "e45", "e50",
"e55", "e60", "e65", "e70",
"e75", "e80", "e85", "e90",
"e95","e100p"))
Ex_M$Age <- NA
Ex_M$Age[Ex_M$variable=="e0"] <- 0
Ex_M$Age[Ex_M$variable=="e1"] <- 1
Ex_M$Age[Ex_M$variable=="e5"] <- 5
Ex_M$Age[Ex_M$variable=="e10"] <- 10
Ex_M$Age[Ex_M$variable=="e15"] <- 15
Ex_M$Age[Ex_M$variable=="e20"] <- 20
Ex_M$Age[Ex_M$variable=="e25"] <- 25
Ex_M$Age[Ex_M$variable=="e30"] <- 30
Ex_M$Age[Ex_M$variable=="e35"] <- 35
Ex_M$Age[Ex_M$variable=="e40"] <- 40
Ex_M$Age[Ex_M$variable=="e45"] <- 45
Ex_M$Age[Ex_M$variable=="e50"] <- 50
Ex_M$Age[Ex_M$variable=="e55"] <- 55
Ex_M$Age[Ex_M$variable=="e60"] <- 60
Ex_M$Age[Ex_M$variable=="e65"] <- 65
Ex_M$Age[Ex_M$variable=="e70"] <- 70
Ex_M$Age[Ex_M$variable=="e75"] <- 75
Ex_M$Age[Ex_M$variable=="e80"] <- 80
Ex_M$Age[Ex_M$variable=="e85"] <- 85
Ex_M$Age[Ex_M$variable=="e90"] <- 90
Ex_M$Age[Ex_M$variable=="e95"] <- 95
Ex_M$Age[Ex_M$variable=="e100p"] <- 100
str(Ex_M)
head(Ex_M)
Ex_M <- as.data.table(Ex_M)
Ex_M=Ex_M[,.(Exp = sum(value)), keyby = .(year)]
head(Ex_M)
head(Ex_M)
Ex_M$Sex <- "m"
save(Ex_M,file="Ex_usa_M.RData")
head(USA_M)
usa_M
head(usa_M)
merge(usa_M,Ex_M)
TOT_m <- merge(usa_M,Ex_M)
TOT_m$mx <-TOT_m$dx.tot.by.Caus/
TOT_m[,.(mx = dx.tot.by.Caus/Exp), keyby = .(year)]
TOT_m$mx <-TOT_m$dx.tot.by.Caus/TOT_m$Exp
head(TOT_m)
TOT_m[,.(mx2 = dx.tot.by.Caus/Exp), keyby = .(year)]
TOT_m[,.(mx2 = dx.tot.by.Caus/Exp), keyby = .(year,Cause_Rev)]
